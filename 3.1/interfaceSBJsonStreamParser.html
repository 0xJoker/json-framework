<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>SBJson: SBJsonStreamParser Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#properties">Properties</a>  </div>
  <div class="headertitle">
<h1>SBJsonStreamParser Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="SBJsonStreamParser" --><!-- doxytag: inherits="NSObject" -->
<p>Parse a stream of JSON data.  
<a href="#_details">More...</a></p>

<p>Inherits NSObject.</p>

<p><a href="classSBJsonStreamParser-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(SBJsonStreamParserStatus)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interfaceSBJsonStreamParser.html#a9c4b15221e738a1eb49079e266daa1bf">parse:</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse some JSON.  <a href="#a9c4b15221e738a1eb49079e266daa1bf"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="properties"></a>
Properties</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSUInteger&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceSBJsonStreamParser.html#a00ce263f19b6dd80f857fdb5552c04e9">levelsToSkip</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">How many levels to skip.  <a href="#a00ce263f19b6dd80f857fdb5552c04e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">BOOL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceSBJsonStreamParser.html#afd976c605b67edbb8b7abbebcc5b4093">supportMultipleDocuments</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Expect multiple documents separated by whitespace.  <a href="#afd976c605b67edbb8b7abbebcc5b4093"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">id&lt; <a class="el" href="protocolSBJsonStreamParserDelegate-p.html">SBJsonStreamParserDelegate</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceSBJsonStreamParser.html#a1a4e90ce1ca9b55e7696db77ef6bf20c">delegate</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delegate to receive messages.  <a href="#a1a4e90ce1ca9b55e7696db77ef6bf20c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSUInteger&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceSBJsonStreamParser.html#a1c6f49cb5dd676452994d96498bb5a3f">maxDepth</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The max parse depth.  <a href="#a1c6f49cb5dd676452994d96498bb5a3f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49c6e710bc367cdc627a4152706f1008"></a><!-- doxytag: member="SBJsonStreamParser::error" ref="a49c6e710bc367cdc627a4152706f1008" args="" -->
NSString *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceSBJsonStreamParser.html#a49c6e710bc367cdc627a4152706f1008">error</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Holds the error after SBJsonStreamParserError was returned. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Using this class directly you can reduce the apparent latency for each download/parse cycle of documents over a slow connection. You can start parsing *and return chunks of the parsed document* before the entire document is downloaded. Using this class is also useful to parse huge documents on disk bit by bit so you don't have to keep them all in memory.</p>
<p>The default behaviour is that the delegate only receives one call from either the -parser:foundArray: or -parser:foundObject: method when the document is fully parsed. However, if your inputs contains multiple JSON documents and you set the parser's -supportMultipleDocuments property to YES you will get one call for each full method.</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="interfaceSBJsonStreamParser.html" title="Parse a stream of JSON data.">SBJsonStreamParser</a> *parser = [[[<a class="code" href="interfaceSBJsonStreamParser.html" title="Parse a stream of JSON data.">SBJsonStreamParser</a> alloc] init] autorelease];
 parser.<a class="code" href="interfaceSBJsonStreamParser.html#a1a4e90ce1ca9b55e7696db77ef6bf20c" title="Delegate to receive messages.">delegate</a> = <span class="keyword">self</span>;
 parser.<a class="code" href="interfaceSBJsonStreamParser.html#afd976c605b67edbb8b7abbebcc5b4093" title="Expect multiple documents separated by whitespace.">supportMultipleDocuments</a> = YES;
 
 <span class="comment">// Note that this input contains multiple top-level JSON documents</span>
 NSData *json = [@&quot;[]{}[]{}&quot; dataWithEncoding:NSUTF8StringEncoding]; 
 [parser <a class="code" href="interfaceSBJsonStreamParser.html#a9c4b15221e738a1eb49079e266daa1bf" title="Parse some JSON.">parse</a>:data];
</pre></div><p>In the above example <code>self</code> will have the following sequence of methods called on it:</p>
<ul>
<li>-parser:foundArray: </li>
<li>-parser:foundObject: </li>
<li>-parser:foundArray: </li>
<li>-parser:foundObject:</li>
</ul>
<p>Often you won't have control over the input you're parsing, so can't make use of this feature. But, all is not lost: this class will let you get the same effect by allowing you to skip one or more of the outer enclosing objects. Thus, the next example results in the same sequence of -parser:foundArray: / -parser:foundObject: being called on your delegate.</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="interfaceSBJsonStreamParser.html" title="Parse a stream of JSON data.">SBJsonStreamParser</a> *parser = [[[<a class="code" href="interfaceSBJsonStreamParser.html" title="Parse a stream of JSON data.">SBJsonStreamParser</a> alloc] init] autorelease];
 parser.<a class="code" href="interfaceSBJsonStreamParser.html#a1a4e90ce1ca9b55e7696db77ef6bf20c" title="Delegate to receive messages.">delegate</a> = <span class="keyword">self</span>;
 parser.<a class="code" href="interfaceSBJsonStreamParser.html#a00ce263f19b6dd80f857fdb5552c04e9" title="How many levels to skip.">levelsToSkip</a> = 1;
 
 <span class="comment">// Note that this input contains A SINGLE top-level document</span>
 NSData *json = [@&quot;[[],{},[],{}]&quot; dataWithEncoding:NSUTF8StringEncoding]; 
 [parser <a class="code" href="interfaceSBJsonStreamParser.html#a9c4b15221e738a1eb49079e266daa1bf" title="Parse some JSON.">parse</a>:data];
</pre></div><dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="protocolSBJsonStreamParserDelegate-p.html" title="SBJsonStreamParserDelegate protocol adapter.">SBJsonStreamParserDelegate</a> </dd>
<dd>
<a class="el" href="objc2json.html">Objective-C to JSON</a> </dd></dl>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a9c4b15221e738a1eb49079e266daa1bf"></a><!-- doxytag: member="SBJsonStreamParser::parse:" ref="a9c4b15221e738a1eb49079e266daa1bf" args="(NSData *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (SBJsonStreamParserStatus) parse: </td>
          <td></td>
          <td class="paramtype">(NSData*)&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The JSON is assumed to be UTF8 encoded. This can be a full JSON document, or a part of one.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>An NSData object containing the next chunk of JSON</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li>SBJsonStreamParserComplete if a full document was found </li>
<li>SBJsonStreamParserWaitingForData if a partial document was found and more data is required to complete it </li>
<li>SBJsonStreamParserError if an error occured. (See the error property for details in this case.) </li>
</ul>
</dd></dl>

</div>
</div>
<hr/><h2>Property Documentation</h2>
<a class="anchor" id="a1a4e90ce1ca9b55e7696db77ef6bf20c"></a><!-- doxytag: member="SBJsonStreamParser::delegate" ref="a1a4e90ce1ca9b55e7696db77ef6bf20c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (id&lt;<a class="el" href="protocolSBJsonStreamParserDelegate-p.html">SBJsonStreamParserDelegate</a>&gt;) delegate<code> [read, write, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The object set here receives a series of messages as the parser breaks down the JSON stream into valid tokens.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Usually this should be an instance of <a class="el" href="interfaceSBJsonStreamParser.html" title="Parse a stream of JSON data.">SBJsonStreamParser</a>, but you can substitute your own implementation of the <a class="el" href="protocolSBJsonStreamParserDelegate-p.html" title="SBJsonStreamParserDelegate protocol adapter.">SBJsonStreamParserDelegate</a> protocol if you need to. </dd></dl>

</div>
</div>
<a class="anchor" id="a00ce263f19b6dd80f857fdb5552c04e9"></a><!-- doxytag: member="SBJsonStreamParser::levelsToSkip" ref="a00ce263f19b6dd80f857fdb5552c04e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSUInteger) levelsToSkip<code> [read, write, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is useful for parsing huge JSON documents, or documents coming in over a very slow link.</p>
<p>If you set this to N it will skip the outer N levels and call the -parser:foundArray: or -parser:foundObject: methods for each of the inner objects, as appropriate.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>The StreamParserIntegrationTest.m file for examples </dd></dl>

</div>
</div>
<a class="anchor" id="a1c6f49cb5dd676452994d96498bb5a3f"></a><!-- doxytag: member="SBJsonStreamParser::maxDepth" ref="a1c6f49cb5dd676452994d96498bb5a3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSUInteger) maxDepth<code> [read, write, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If the input is nested deeper than this the parser will halt parsing and return an error.</p>
<p>Defaults to 32. </p>

</div>
</div>
<a class="anchor" id="afd976c605b67edbb8b7abbebcc5b4093"></a><!-- doxytag: member="SBJsonStreamParser::supportMultipleDocuments" ref="afd976c605b67edbb8b7abbebcc5b4093" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) supportMultipleDocuments<code> [read, write, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Normally the <code>-parse</code>: method returns SBJsonStreamParserComplete when it's found a complete JSON document. Attempting to parse any more data at that point is considered an error. ("Garbage after JSON".)</p>
<p>If you set this property to true the parser will never return SBJsonStreamParserComplete. Rather, once an object is completed it will expect another object to immediately follow, separated only by (optional) whitespace.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>The TweetStream app in the Examples </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Classes/<a class="el" href="SBJsonStreamParser_8h_source.html">SBJsonStreamParser.h</a></li>
<li>Classes/SBJsonStreamParser.m</li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Jul 30 2011 15:56:17 for SBJson by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
